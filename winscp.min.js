function WinSCP(){var l=[],n="0123456789ABCDEF",o=255;function h(r,t){return Math.floor(Math.random()*(t-r+1))+r}function i(r){return[n[(240&(r=163^~r))>>4],n[(15&r)>>0]].join("")}function f(){if(0==l.length)return 0;var r=n.indexOf(l.shift()),t=n.indexOf(l.shift());return o&~((r<<4)+t<<0^163)}this.encrypt=function(r,t,n){var e=r+""+t+n,u=0;e.length<50&&(u=h(0,50-e.length)),result=[],result.push(i(o)),result.push(i(0)),result.push(i(e.length)),result.push(i(u));for(var s=0;s<u;s++)result.push(i(h(0,256)));for(s=0;s<e.length;s++)result.push(i(e[s].charCodeAt(0)));for(;result.length<100;)result.push(i(h(0,256)));return result.join("")},this.decrypt=function(r,t,n){if(!n.match(/[A-F0-9]+/))return"";var e=[],u=r+""+t;l=n.split("");var s,h=f();s=h==o?(f(),f()):h,l=l.slice(2*f());for(var i=0;i<s;i++)e.push(String.fromCharCode(f()));h==o&&(e=e.slice(0,u.length).join("")!=u?[]:e.slice(u.length));return l=[],e.join("")}}
